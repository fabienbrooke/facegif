(function(e){function h(i,s,o,u,a){if(i){console.log("Error creating video stream",i);return}t=o;var f=r[0].getBoundingClientRect();var l=f.width;var c=g(u,a,l,l);e(t).css({width:l+c.width+"px",height:l+c.height+"px","margin-left":-Math.floor(c.width/2)+"px","margin-top":-Math.floor(c.height/2)+"px"});n={interval:.15,numFrames:15,gifWidth:l,gifHeight:l,cameraStream:s,keepCameraOn:true,progressCallback:v,text:"faceGIF.com",fontFamily:"Source Sans Pro",fontColor:"rgba(255,255,255,0.8)",textXCoordinate:l-50,textYCoordinate:l-5};e("#actions").show();p()}function p(){r.find("img").remove();r.append(t);t.play();c.set(0);s.hide();i.fadeIn();f.create.one("click",d);e(window).on("keyup",function n(t){if(t.keyCode==32){e(window).off("keyup",n);d()}})}function d(){a.addClass("rotating");c.path.setAttribute("stroke",l);e(c.svg).show();gifshot.createGIF(n,m)}function v(e){if(e===1){c.path.setAttribute("stroke","rgba(44,146,54,0.2)");t.pause();a.removeClass("rotating");u.fadeIn()}c.set(e)}function m(t){if(t.error){console.log("Error creating GIF",t.error);return}u.hide();e(c.svg).hide();var n=t.image;var o=document.createElement("img");o.src=n;r.find("video").remove();r.append(o);i.hide();s.fadeIn();f.download.attr({href:n,download:"facegif.gif"});f.reset.one("click",p)}function g(e,t,n,r){var i={width:0,height:0,scaledWidth:0,scaledHeight:0};if(e>t){i.width=Math.round(e*(r/t))-n;i.scaledWidth=Math.round(i.width*(t/r))}else{i.height=Math.round(t*(n/e))-r;i.scaledHeight=Math.round(i.height*(e/n))}return i}var t;var n;var r=e("#placeholder");var i=e("#stream-actions");var s=e("#gif-actions");var o=e("#action-create");var u=e(".loader");var a=o.find("img");var f={create:o,reset:e("#action-reset"),download:e("#action-download"),share:e("#action-share")};var l="rgba(44,146,54,0.8)";var c=new ProgressBar.Line(".progress-bar",{color:l,strokeWidth:3,duration:1,trailColor:"rgba(221,221,221,0.6)"});if(navigator.getMedia){GumHelper.startVideoStreaming(h)}else{r.text("Your browser does not support video capture.")}})(jQuery)
