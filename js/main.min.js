(function(e){function c(i,s,o,u,a){if(i){console.log("Error creating video stream",i);return}t=o;var f=r[0].getBoundingClientRect();var l=f.width;var c=m(u,a,l,l);e(t).css({width:l+c.width+"px",height:l+c.height+"px","margin-left":-Math.floor(c.width/2)+"px","margin-top":-Math.floor(c.height/2)+"px"});n={interval:.15,numFrames:15,gifWidth:l,gifHeight:l,cameraStream:s,keepCameraOn:true,progressCallback:d,text:"faceGIF.com",fontFamily:"Source Sans Pro",fontColor:"rgba(255,255,255,0.8)",textXCoordinate:l-50,textYCoordinate:l-5};e("#actions").show();h()}function h(){r.empty();r.append(t);t.play();l.set(0);s.hide();i.fadeIn();a.create.one("click",p);e(window).on("keyup",function n(t){if(t.keyCode==32){e(window).off("keyup",n);p()}})}function p(){u.addClass("rotating");l.path.setAttribute("stroke",f);e(l.svg).show();gifshot.createGIF(n,v)}function d(e){if(e===1){l.path.setAttribute("stroke","rgba(44,146,54,0.2)");u.removeClass("rotating")}l.set(e)}function v(t){if(t.error){console.log("Error creating GIF",t.error);return}e(l.svg).hide();var n=t.image;var o=document.createElement("img");o.src=n;r.empty();r.append(o);i.hide();s.fadeIn();a.download.attr({href:n,download:"facegif.gif"});a.reset.one("click",h)}function m(e,t,n,r){var i={width:0,height:0,scaledWidth:0,scaledHeight:0};if(e>t){i.width=Math.round(e*(r/t))-n;i.scaledWidth=Math.round(i.width*(t/r))}else{i.height=Math.round(t*(n/e))-r;i.scaledHeight=Math.round(i.height*(e/n))}return i}var t;var n;var r=e("#placeholder");var i=e("#stream-actions");var s=e("#gif-actions");var o=e("#action-create");var u=o.find("img");var a={create:o,reset:e("#action-reset"),download:e("#action-download"),share:e("#action-share")};var f="rgba(44,146,54,0.8)";var l=new ProgressBar.Line("#actions",{color:f,strokeWidth:3,duration:1,trailColor:"rgba(221,221,221,0.6)"});if(navigator.getMedia){GumHelper.startVideoStreaming(c)}else{r.text("Your browser does not support video capture.")}})(jQuery)